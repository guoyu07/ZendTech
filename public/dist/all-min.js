"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _slicedToArray=function(){function e(e,t){var r=[],o=!0,n=!1,l=void 0;try{for(var a,u=e[Symbol.iterator]();!(o=(a=u.next()).done)&&(r.push(a.value),!t||r.length!==t);o=!0);}catch(e){n=!0,l=e}finally{try{!o&&u.return&&u.return()}finally{if(n)throw l}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_templates=require("../../../helpers/templates.js"),_templates2=_interopRequireDefault(_templates),_notifier=require("../../../helpers/notifier.js"),_notifier2=_interopRequireDefault(_notifier),_blogsData=require("../data/blogs-data.js"),_blogsData2=_interopRequireDefault(_blogsData);exports.default={all:function(e){Promise.all([_blogsData2.default.all(),_templates2.default.load("list-blogs")]).then(function(t){var r=_slicedToArray(t,2),o=r[0],n=r[1];console.log(o),e.$element().html(n({blogs:o}))})},home:function(e){Promise.all([_blogsData2.default.all(),_templates2.default.load("home")]).then(function(t){var r=_slicedToArray(t,2),o=r[0],n=r[1],l=[];l.push(o[3]),l.push(o[6]),l.push(o[1]),e.$element().html(n({blogs:l,fromTheBlog:o}))})},byId:function(e){var t=e.params.id;Promise.all([_blogsData2.default.byId(t),_templates2.default.load("blog")]).then(function(r){var o=_slicedToArray(r,2),n=o[0],l=o[1],a=localStorage.getItem("user"),u=JSON.parse(a);e.$element().html(l(n.blog)),$("#leave-reply-submit").on("click",function(e){e.preventDefault();var r={content:$("#leave-reply-text").val(),postedBy:u.username||"Stranger"};_blogsData2.default.addComment(t,r),location.reload(!0)})})},post:function(e){_templates2.default.load("blog-create").then(function(t){e.$element().html(t()),$("#btn-create-post").on("click",function(){var t=localStorage.getItem("user"),r=JSON.parse(t),o={title:$("#title").val(),category:$("#category").val(),image:$("#image").val(),videoUrl:$("#videoUrl").val(),article:$("#article").val(),postedBy:r.username};_blogsData2.default.create(o).then(function(){_notifier2.default.send("Post created!"),e.redirect("#/home")})})})}},Object.defineProperty(exports,"__esModule",{value:!0}),require("jquery");var _userData=require("../data/user-data.js"),_userData2=_interopRequireDefault(_userData),_templates=require("../../../helpers/templates.js"),_templates2=_interopRequireDefault(_templates),_notifier=require("../../../helpers/notifier.js"),_notifier2=_interopRequireDefault(_notifier);exports.default={register:function(e){_templates2.default.load("register").then(function(t){e.$element().html(t()),$("#btn-reg").on("click",function(){var t=$("#reg-username").val(),r=$("#reg-password").val(),o=$("#reg-email").val();(t.length<6||r.length<6)&&(_notifier2.default.send("Invalid username or password"),_notifier2.default.explain("Password and username must be longer than 6 symbols","Check your input","warning"));var n={username:t,password:r,email:o};_userData2.default.register(n).then(function(t){$("#register").hide(),$("#logout").show(),_notifier2.default.send(t.username+" registered!"),e.redirect("#/home")})})})},login:function(e){_templates2.default.load("login").then(function(t){e.$element().html(t()),$("#btn-login").on("click",function(){var t={username:$("#login-username").val(),password:$("#login-password").val()};_userData2.default.login(t).then(function(t){$("#login").hide(),$("#register").hide(),$("#logout").show(),localStorage.setItem("user",JSON.stringify(t)),_notifier2.default.send(t.username+" logged in!"),_notifier2.default.explain("Welcome!","Now you can leave comments!","ok"),e.redirect("#/home")})})})}},Object.defineProperty(exports,"__esModule",{value:!0});var _requester=require("../../../helpers/requester.js"),_requester2=_interopRequireDefault(_requester);exports.default={all:function(){return _requester2.default.get("/blogs")},byId:function(e){return _requester2.default.get("/blogs/"+e).then(function(e){return e})},create:function(e){return _requester2.default.post("/blogs",e)},addComment:function(e,t){return _requester2.default.post("/blogs/"+e,t)}},Object.defineProperty(exports,"__esModule",{value:!0});var _requester=require("../../../helpers/requester.js"),_requester2=_interopRequireDefault(_requester);exports.default={register:function(e){return _requester2.default.post("/register",e).then(function(e){return e.resUser})},login:function(e){return _requester2.default.post("/login",e).then(function(e){return e.user})},logout:function(){return _requester2.default.post("/logout").then(function(e){console.log(e)})}},require("jquery"),$(document).ready(function(){$(".loader").fadeOut("slow")}),Object.defineProperty(exports,"__esModule",{value:!0}),require("jquery"),require("amaran"),exports.default={send:function(e){$.amaran({message:e,position:"top right",delay:5e3})},explain:function(e,t,r){$.amaran({theme:"awesome "+r||"",content:{title:e||"",message:t,info:""},position:"top right",delay:5e3})}},Object.defineProperty(exports,"__esModule",{value:!0}),require("jquery"),exports.default={get:function(e,t){return new Promise(function(r,o){$.ajax({url:e,method:"GET",contentType:"application/json",headers:t,success:function(e){r(e)},error:function(e){o(e)}})})},post:function(e,t,r){return new Promise(function(o,n){$.ajax({url:e,method:"POST",headers:r,contentType:"application/json",data:JSON.stringify(t),success:function(e){o(e)},error:function(e){n(e)}})})},put:function(e,t,r){return new Promise(function(o,n){$.ajax({url:e,method:"PUT",headers:r,contentType:"application/json",data:JSON.stringify(t),success:function(e){o(e)},error:function(e){n(e)}})})},del:function(e,t,r){return new Promise(function(o,n){$.ajax({url:e,method:"DELETE",headers:r,contentType:"application/json",data:JSON.stringify(t),success:function(e){o(e)},error:function(e){n(e)}})})}},Object.defineProperty(exports,"__esModule",{value:!0}),require("jquery");var handlebars=window.handlebars||window.Handlebars;exports.default={load:function(e){var t="app/js/templates/"+e+".handlebars";return new Promise(function(e,r){$.ajax({url:t,success:function(t){e(handlebars.compile(t))},error:function(e){r(e)}})})}};var _blogsController=require("./app/js/controllers/blogsController.js"),_blogsController2=_interopRequireDefault(_blogsController),_usersController=require("./app/js/controllers/usersController.js"),_usersController2=_interopRequireDefault(_usersController),_notifier=require("./helpers/notifier.js"),_notifier2=_interopRequireDefault(_notifier);require("./helpers/loader.js"),function(){var e=Sammy("#content",function(){this.get("#/",function(){this.redirect("#/home")}),this.get("#/home",_blogsController2.default.home),this.get("#/blog/:id",_blogsController2.default.byId),this.get("#/blogs",_blogsController2.default.all),this.get("#/blogs/add",_blogsController2.default.post),this.get("#/register",_usersController2.default.register),this.get("#/login",_usersController2.default.login)});$(function(){e.run("#/"),$("#logout").on("click",function(){localStorage.clear(),$("#register").show(),$("#login").show(),$("#logout").hide(),_notifier2.default.send("You logged out")})})}();